{"version":3,"file":"react-piano.cjs.js","sources":["../src/MidiNumbers.js","../src/Key.js","../src/Keyboard.js","../src/ControlledPiano.js","../src/Piano.js","../src/KeyboardShortcuts.js"],"sourcesContent":["import range from 'just-range';\n\nconst SORTED_PITCHES = ['C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'];\nconst ACCIDENTAL_PITCHES = ['Db', 'Eb', 'Gb', 'Ab', 'Bb'];\nconst PITCH_INDEXES = {\n  C: 0,\n  'C#': 1,\n  Db: 1,\n  D: 2,\n  'D#': 3,\n  Eb: 3,\n  E: 4,\n  F: 5,\n  'F#': 6,\n  Gb: 6,\n  G: 7,\n  'G#': 8,\n  Ab: 8,\n  A: 9,\n  'A#': 10,\n  Bb: 10,\n  B: 11,\n};\nconst MIDI_NUMBER_C0 = 12;\nconst MIN_MIDI_NUMBER = MIDI_NUMBER_C0;\nconst MAX_MIDI_NUMBER = 127;\nconst NOTE_REGEX = /([a-g])([#b]?)(\\d+)/;\nconst NOTES_IN_OCTAVE = 12;\n\n// Converts string notes in scientific pitch notation to a MIDI number, or null.\n//\n// Example: \"c#0\" => 13, \"eb5\" => 75, \"abc\" => null\n//\n// References:\n// - http://www.flutopedia.com/octave_notation.htm\n// - https://github.com/danigb/tonal/blob/master/packages/note/index.js\nfunction fromNote(note) {\n  if (!note) {\n    throw Error('Invalid note argument');\n  }\n  const match = NOTE_REGEX.exec(note.toLowerCase());\n  if (!match) {\n    throw Error('Invalid note argument');\n  }\n  const [, letter, accidental, octave] = match;\n  const pitchName = `${letter.toUpperCase()}${accidental}`;\n  const pitchIndex = PITCH_INDEXES[pitchName];\n  if (pitchIndex == null) {\n    throw Error('Invalid note argument');\n  }\n  return MIDI_NUMBER_C0 + pitchIndex + NOTES_IN_OCTAVE * parseInt(octave, 10);\n}\n\n//\n// Build cache for getAttributes\n//\nfunction buildMidiNumberAttributes(midiNumber) {\n  const pitchIndex = (midiNumber - MIDI_NUMBER_C0) % NOTES_IN_OCTAVE;\n  const octave = Math.floor((midiNumber - MIDI_NUMBER_C0) / NOTES_IN_OCTAVE);\n  const pitchName = SORTED_PITCHES[pitchIndex];\n  return {\n    note: `${pitchName}${octave}`,\n    pitchName,\n    octave,\n    midiNumber,\n    isAccidental: ACCIDENTAL_PITCHES.includes(pitchName),\n  };\n}\n\nfunction buildMidiNumberAttributesCache() {\n  return range(MIN_MIDI_NUMBER, MAX_MIDI_NUMBER + 1).reduce((cache, midiNumber) => {\n    cache[midiNumber] = buildMidiNumberAttributes(midiNumber);\n    return cache;\n  }, {});\n}\n\nconst midiNumberAttributesCache = buildMidiNumberAttributesCache();\n\n// Returns an object containing various attributes for a given MIDI number.\n// Throws error for invalid midiNumbers.\nfunction getAttributes(midiNumber) {\n  const attrs = midiNumberAttributesCache[midiNumber];\n  if (!attrs) {\n    throw Error('Invalid MIDI number');\n  }\n  return attrs;\n}\n\n// Returns all MIDI numbers corresponding to natural notes, e.g. C and not C# or Bb.\nconst NATURAL_MIDI_NUMBERS = range(MIN_MIDI_NUMBER, MAX_MIDI_NUMBER + 1).filter(\n  (midiNumber) => !getAttributes(midiNumber).isAccidental,\n);\n\nexport default {\n  fromNote,\n  getAttributes,\n  MIN_MIDI_NUMBER,\n  MAX_MIDI_NUMBER,\n  NATURAL_MIDI_NUMBERS,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\n\nimport MidiNumbers from './MidiNumbers';\n\nclass Key extends React.Component {\n  static propTypes = {\n    midiNumber: PropTypes.number.isRequired,\n    naturalKeyWidth: PropTypes.number.isRequired, // Width as a ratio between 0 and 1\n    gliss: PropTypes.bool.isRequired,\n    useTouchEvents: PropTypes.bool.isRequired,\n    accidental: PropTypes.bool.isRequired,\n    active: PropTypes.bool.isRequired,\n    highlighted: PropTypes.bool.isRequired,\n    disabled: PropTypes.bool.isRequired,\n    onPlayNoteInput: PropTypes.func.isRequired,\n    onStopNoteInput: PropTypes.func.isRequired,\n    accidentalWidthRatio: PropTypes.number.isRequired,\n    pitchPositions: PropTypes.object.isRequired,\n    children: PropTypes.node,\n  };\n\n  static defaultProps = {\n    accidentalWidthRatio: 0.65,\n    pitchPositions: {\n      C: 0,\n      Db: 0.55,\n      D: 1,\n      Eb: 1.8,\n      E: 2,\n      F: 3,\n      Gb: 3.5,\n      G: 4,\n      Ab: 4.7,\n      A: 5,\n      Bb: 5.85,\n      B: 6,\n    },\n  };\n\n  onPlayNoteInput = () => {\n    this.props.onPlayNoteInput(this.props.midiNumber);\n    console.log('PLAYNOTEINPUT PROPS', this.props);\n  };\n\n  onStopNoteInput = () => {\n    this.props.onStopNoteInput(this.props.midiNumber);\n  };\n\n  // Key position is represented by the number of natural key widths from the left\n  getAbsoluteKeyPosition(midiNumber) {\n    const OCTAVE_WIDTH = 7;\n    const { octave, pitchName } = MidiNumbers.getAttributes(midiNumber);\n    const pitchPosition = this.props.pitchPositions[pitchName];\n    const octavePosition = OCTAVE_WIDTH * octave;\n    return pitchPosition + octavePosition;\n  }\n\n  getRelativeKeyPosition(midiNumber) {\n    return (\n      this.getAbsoluteKeyPosition(midiNumber) -\n      this.getAbsoluteKeyPosition(this.props.noteRange.first)\n    );\n  }\n\n  render() {\n    const {\n      naturalKeyWidth,\n      accidentalWidthRatio,\n      midiNumber,\n      gliss,\n      useTouchEvents,\n      accidental,\n      active,\n      highlighted,\n      disabled,\n      children,\n    } = this.props;\n\n    // Need to conditionally include/exclude handlers based on useTouchEvents,\n    // because otherwise mobile taps double fire events.\n    return (\n      <div\n        className={classNames(\n          'ReactPiano__Key',\n          {\n            'ReactPiano__Key--accidental': accidental,\n            'ReactPiano__Key--natural': !accidental,\n            'ReactPiano__Key--disabled': disabled,\n            'ReactPiano__Key--active': active,\n            'ReactPiano__Key--active': highlighted,\n          },\n          `MidiNumber--${this.props.midiNumber}`,\n        )}\n        style={{\n          left: ratioToPercentage(this.getRelativeKeyPosition(midiNumber) * naturalKeyWidth),\n          width: ratioToPercentage(\n            accidental ? accidentalWidthRatio * naturalKeyWidth : naturalKeyWidth,\n          ),\n        }}\n        onMouseDown={useTouchEvents ? null : this.onPlayNoteInput}\n        onMouseUp={useTouchEvents ? null : this.onStopNoteInput}\n        onMouseEnter={gliss ? this.onPlayNoteInput : null}\n        onMouseLeave={this.onStopNoteInput}\n        onTouchStart={useTouchEvents ? this.onPlayNoteInput : null}\n        onTouchCancel={useTouchEvents ? this.onStopNoteInput : null}\n        onTouchEnd={useTouchEvents ? this.onStopNoteInput : null}\n      >\n        <div className=\"ReactPiano__NoteLabelContainer\">{children}</div>\n      </div>\n    );\n  }\n}\n\nfunction ratioToPercentage(ratio) {\n  return `${ratio * 100}%`;\n}\n\nexport default Key;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport range from 'just-range';\nimport classNames from 'classnames';\n\nimport Key from './Key';\nimport MidiNumbers from './MidiNumbers';\n\nclass Keyboard extends React.Component {\n  static propTypes = {\n    noteRange: noteRangePropType,\n    activeNotes: PropTypes.arrayOf(PropTypes.number),\n    highlightedNotes: PropTypes.arrayOf(PropTypes.number),\n    onPlayNoteInput: PropTypes.func.isRequired,\n    onStopNoteInput: PropTypes.func.isRequired,\n    renderNoteLabel: PropTypes.func.isRequired,\n    keyWidthToHeight: PropTypes.number.isRequired,\n    className: PropTypes.string,\n    disabled: PropTypes.bool,\n    gliss: PropTypes.bool,\n    useTouchEvents: PropTypes.bool,\n    // If width is not provided, must have fixed width and height in parent container\n    width: PropTypes.number,\n  };\n\n  static defaultProps = {\n    disabled: false,\n    gliss: false,\n    useTouchEvents: false,\n    keyWidthToHeight: 0.33,\n    renderNoteLabel: () => {},\n  };\n\n  // Range of midi numbers on keyboard\n  getMidiNumbers() {\n    return range(this.props.noteRange.first, this.props.noteRange.last + 1);\n  }\n\n  getNaturalKeyCount() {\n    return this.getMidiNumbers().filter((number) => {\n      const { isAccidental } = MidiNumbers.getAttributes(number);\n      return !isAccidental;\n    }).length;\n  }\n\n  // Returns a ratio between 0 and 1\n  getNaturalKeyWidth() {\n    return 1 / this.getNaturalKeyCount();\n  }\n\n  getWidth() {\n    return this.props.width ? this.props.width : '100%';\n  }\n\n  getHeight() {\n    if (!this.props.width) {\n      return '100%';\n    }\n    const keyWidth = this.props.width * this.getNaturalKeyWidth();\n    return `${keyWidth / this.props.keyWidthToHeight}px`;\n  }\n\n  render() {\n    const naturalKeyWidth = this.getNaturalKeyWidth();\n    return (\n      <div\n        className={classNames('ReactPiano__Keyboard', this.props.className)}\n        style={{ width: this.getWidth(), height: this.getHeight() }}\n      >\n        {this.getMidiNumbers().map((midiNumber) => {\n          const { note, isAccidental } = MidiNumbers.getAttributes(midiNumber);\n          const isActive = !this.props.disabled && this.props.activeNotes.includes(midiNumber);\n          const isHighlighted =\n            !this.props.disabled && this.props.highlightedNotes.includes(midiNumber);\n          return (\n            <Key\n              naturalKeyWidth={naturalKeyWidth}\n              midiNumber={midiNumber}\n              noteRange={this.props.noteRange}\n              active={isActive}\n              highlighted={isHighlighted}\n              accidental={isAccidental}\n              disabled={this.props.disabled}\n              onPlayNoteInput={this.props.onPlayNoteInput}\n              onStopNoteInput={this.props.onStopNoteInput}\n              gliss={this.props.gliss}\n              useTouchEvents={this.props.useTouchEvents}\n              key={midiNumber}\n            >\n              {this.props.disabled\n                ? null\n                : this.props.renderNoteLabel({\n                    isActive,\n                    isHighlighted,\n                    isAccidental,\n                    midiNumber,\n                  })}\n            </Key>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nfunction isNaturalMidiNumber(value) {\n  if (typeof value !== 'number') {\n    return false;\n  }\n  return MidiNumbers.NATURAL_MIDI_NUMBERS.includes(value);\n}\n\nfunction noteRangePropType(props, propName, componentName) {\n  const { first, last } = props[propName];\n  if (!first || !last) {\n    return new Error(\n      `Invalid prop ${propName} supplied to ${componentName}. ${propName} must be an object with .first and .last values.`,\n    );\n  }\n  if (!isNaturalMidiNumber(first) || !isNaturalMidiNumber(last)) {\n    return new Error(\n      `Invalid prop ${propName} supplied to ${componentName}. ${propName} values must be valid MIDI numbers, and should not be accidentals (sharp or flat notes).`,\n    );\n  }\n  if (first >= last) {\n    return new Error(\n      `Invalid prop ${propName} supplied to ${componentName}. ${propName}.first must be smaller than ${propName}.last.`,\n    );\n  }\n}\n\nexport default Keyboard;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport difference from 'lodash.difference';\nimport Keyboard from './Keyboard';\n\nclass ControlledPiano extends React.Component {\n  static propTypes = {\n    noteRange: PropTypes.object.isRequired,\n    activeNotes: PropTypes.arrayOf(PropTypes.number.isRequired).isRequired,\n    highlightedNotes: PropTypes.arrayOf(PropTypes.number.isRequired).isRequired,\n    playNote: PropTypes.func.isRequired,\n    stopNote: PropTypes.func.isRequired,\n    onPlayNoteInput: PropTypes.func.isRequired,\n    onStopNoteInput: PropTypes.func.isRequired,\n    renderNoteLabel: PropTypes.func.isRequired,\n    className: PropTypes.string,\n    disabled: PropTypes.bool,\n    width: PropTypes.number,\n    keyWidthToHeight: PropTypes.number,\n    keyboardShortcuts: PropTypes.arrayOf(\n      PropTypes.shape({\n        key: PropTypes.string.isRequired,\n        midiNumber: PropTypes.number.isRequired,\n      }),\n    ),\n  };\n\n  static defaultProps = {\n    renderNoteLabel: ({ keyboardShortcut, midiNumber, isActive, isAccidental }) =>\n      keyboardShortcut ? (\n        <div\n          className={classNames('ReactPiano__NoteLabel', {\n            'ReactPiano__NoteLabel--active': isActive,\n            'ReactPiano__NoteLabel--accidental': isAccidental,\n            'ReactPiano__NoteLabel--natural': !isAccidental,\n          })}\n        >\n          {keyboardShortcut}\n        </div>\n      ) : null,\n  };\n\n  state = {\n    isMouseDown: false,\n    useTouchEvents: false,\n  };\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onKeyDown);\n    window.addEventListener('keyup', this.onKeyUp);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onKeyDown);\n    window.removeEventListener('keyup', this.onKeyUp);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.activeNotes !== prevProps.activeNotes) {\n      this.handleNoteChanges({\n        prevActiveNotes: prevProps.activeNotes || [],\n        nextActiveNotes: this.props.activeNotes || [],\n      });\n    }\n  }\n\n  // This function is responsible for diff'ing activeNotes\n  // and playing or stopping notes accordingly.\n  handleNoteChanges = ({ prevActiveNotes, nextActiveNotes }) => {\n    if (this.props.disabled) {\n      return;\n    }\n    const notesStopped = difference(prevActiveNotes, nextActiveNotes);\n    const notesStarted = difference(nextActiveNotes, prevActiveNotes);\n    notesStarted.forEach((midiNumber) => {\n      this.props.playNote(midiNumber);\n    });\n    notesStopped.forEach((midiNumber) => {\n      this.props.stopNote(midiNumber);\n    });\n  };\n\n  getMidiNumberForKey = (key) => {\n    if (!this.props.keyboardShortcuts) {\n      return null;\n    }\n    const shortcut = this.props.keyboardShortcuts.find((sh) => sh.key === key);\n    return shortcut && shortcut.midiNumber;\n  };\n\n  getKeyForMidiNumber = (midiNumber) => {\n    if (!this.props.keyboardShortcuts) {\n      return null;\n    }\n    const shortcut = this.props.keyboardShortcuts.find((sh) => sh.midiNumber === midiNumber);\n    return shortcut && shortcut.key;\n  };\n\n  onKeyDown = (event) => {\n    // Don't conflict with existing combinations like ctrl + t\n    if (event.ctrlKey || event.metaKey || event.shiftKey) {\n      return;\n    }\n    const midiNumber = this.getMidiNumberForKey(event.key);\n    if (midiNumber) {\n      this.onPlayNoteInput(midiNumber);\n    }\n  };\n\n  onKeyUp = (event) => {\n    // This *should* also check for event.ctrlKey || event.metaKey || event.ShiftKey like onKeyDown does,\n    // but at least on Mac Chrome, when mashing down many alphanumeric keystrokes at once,\n    // ctrlKey is fired unexpectedly, which would cause onStopNote to NOT be fired, which causes problematic\n    // lingering notes. Since it's fairly safe to call onStopNote even when not necessary,\n    // the ctrl/meta/shift check is removed to fix that issue.\n    const midiNumber = this.getMidiNumberForKey(event.key);\n    if (midiNumber) {\n      this.onStopNoteInput(midiNumber);\n    }\n  };\n\n  onPlayNoteInput = (midiNumber) => {\n    if (this.props.disabled) {\n      return;\n    }\n    // Pass in previous activeNotes for recording functionality\n    this.props.onPlayNoteInput(midiNumber, this.props.activeNotes);\n  };\n\n  onStopNoteInput = (midiNumber) => {\n    if (this.props.disabled) {\n      return;\n    }\n    // Pass in previous activeNotes for recording functionality\n    this.props.onStopNoteInput(midiNumber, this.props.activeNotes);\n  };\n\n  onMouseDown = () => {\n    this.setState({\n      isMouseDown: true,\n    });\n  };\n\n  onMouseUp = () => {\n    this.setState({\n      isMouseDown: false,\n    });\n  };\n\n  onTouchStart = () => {\n    this.setState({\n      useTouchEvents: true,\n    });\n  };\n\n  renderNoteLabel = ({ midiNumber, isActive, isAccidental }) => {\n    const keyboardShortcut = this.getKeyForMidiNumber(midiNumber);\n    return this.props.renderNoteLabel({ keyboardShortcut, midiNumber, isActive, isAccidental });\n  };\n\n  render() {\n    return (\n      <div\n        style={{ width: '100%', height: '100%' }}\n        onMouseDown={this.onMouseDown}\n        onMouseUp={this.onMouseUp}\n        onTouchStart={this.onTouchStart}\n        data-testid=\"container\"\n      >\n        <Keyboard\n          noteRange={this.props.noteRange}\n          onPlayNoteInput={this.onPlayNoteInput}\n          onStopNoteInput={this.onStopNoteInput}\n          activeNotes={this.props.activeNotes}\n          highlightedNotes={this.props.highlightedNotes}\n          className={this.props.className}\n          disabled={this.props.disabled}\n          width={this.props.width}\n          keyWidthToHeight={this.props.keyWidthToHeight}\n          gliss={this.state.isMouseDown}\n          useTouchEvents={this.state.useTouchEvents}\n          renderNoteLabel={this.renderNoteLabel}\n        />\n      </div>\n    );\n  }\n}\n\nexport default ControlledPiano;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport difference from 'lodash.difference';\nimport ControlledPiano from './ControlledPiano';\nimport Keyboard from './Keyboard';\n\nclass Piano extends React.Component {\n  static propTypes = {\n    noteRange: PropTypes.object.isRequired,\n    activeNotes: PropTypes.arrayOf(PropTypes.number.isRequired),\n    highlightedNotes: PropTypes.arrayOf(PropTypes.number.isRequired),\n    playNote: PropTypes.func.isRequired,\n    stopNote: PropTypes.func.isRequired,\n    onPlayNoteInput: PropTypes.func,\n    onStopNoteInput: PropTypes.func,\n    renderNoteLabel: PropTypes.func,\n    className: PropTypes.string,\n    disabled: PropTypes.bool,\n    width: PropTypes.number,\n    keyWidthToHeight: PropTypes.number,\n    keyboardShortcuts: PropTypes.arrayOf(\n      PropTypes.shape({\n        key: PropTypes.string.isRequired,\n        midiNumber: PropTypes.number.isRequired,\n      }),\n    ),\n  };\n\n  state = {\n    activeNotes: this.props.activeNotes || [],\n    highlightedNotes: this.props.highlightedNotes || [],\n  };\n\n  componentDidUpdate(prevProps) {\n    // Make activeNotes \"controllable\" by using internal\n    // state by default, but allowing prop overrides.\n    if (\n      prevProps.activeNotes !== this.props.activeNotes &&\n      this.state.activeNotes !== this.props.activeNotes\n    ) {\n      this.setState({\n        activeNotes: this.props.activeNotes || [],\n      });\n    }\n    if (\n      prevProps.highlightedNotes !== this.props.highlightedNotes &&\n      this.state.highlightedNotes !== this.props.highlightedNotes\n    ) {\n      this.setState({\n        highlightedNotes: this.props.highlightedNotes || [],\n      });\n    }\n  }\n\n  handlePlayNoteInput = (midiNumber) => {\n    this.setState((prevState) => {\n      // Need to be handled inside setState in order to set prevActiveNotes without\n      // race conditions.\n      if (this.props.onPlayNoteInput) {\n        this.props.onPlayNoteInput(midiNumber, { prevActiveNotes: prevState.activeNotes });\n      }\n\n      // Don't append note to activeNotes if it's already present\n      if (prevState.activeNotes.includes(midiNumber)) {\n        return null;\n      }\n      return {\n        activeNotes: prevState.activeNotes.concat(midiNumber),\n      };\n    });\n  };\n\n  handleStopNoteInput = (midiNumber) => {\n    this.setState((prevState) => {\n      // Need to be handled inside setState in order to set prevActiveNotes without\n      // race conditions.\n      if (this.props.onStopNoteInput) {\n        this.props.onStopNoteInput(midiNumber, { prevActiveNotes: this.state.activeNotes });\n      }\n      return {\n        activeNotes: prevState.activeNotes.filter((note) => midiNumber !== note),\n      };\n    });\n  };\n\n  render() {\n    const { activeNotes, onPlayNoteInput, onStopNoteInput, ...otherProps } = this.props;\n    return (\n      <ControlledPiano\n        activeNotes={this.state.activeNotes}\n        highlightedNotes={this.state.highlightedNotes}\n        onPlayNoteInput={this.handlePlayNoteInput}\n        onStopNoteInput={this.handleStopNoteInput}\n        {...otherProps}\n      />\n    );\n  }\n}\n\nexport default Piano;\n","import MidiNumbers from './MidiNumbers';\n\nfunction createKeyboardShortcuts({ firstNote, lastNote, keyboardConfig }) {\n  let currentMidiNumber = firstNote;\n  let naturalKeyIndex = 0;\n  let keyboardShortcuts = [];\n\n  while (\n    // There are still keys to be assigned\n    naturalKeyIndex < keyboardConfig.length &&\n    // Note to be assigned does not surpass range\n    currentMidiNumber <= lastNote\n  ) {\n    const key = keyboardConfig[naturalKeyIndex];\n    const { isAccidental } = MidiNumbers.getAttributes(currentMidiNumber);\n    if (isAccidental) {\n      keyboardShortcuts.push({\n        key: key.flat,\n        midiNumber: currentMidiNumber,\n      });\n    } else {\n      keyboardShortcuts.push({\n        key: key.natural,\n        midiNumber: currentMidiNumber,\n      });\n      naturalKeyIndex += 1;\n    }\n    currentMidiNumber += 1;\n  }\n  return keyboardShortcuts;\n}\n\nexport default {\n  create: createKeyboardShortcuts,\n  // Preset configurations\n  BOTTOM_ROW: [\n    { natural: 'z', flat: 'a', sharp: 's' },\n    { natural: 'x', flat: 's', sharp: 'd' },\n    { natural: 'c', flat: 'd', sharp: 'f' },\n    { natural: 'v', flat: 'f', sharp: 'g' },\n    { natural: 'b', flat: 'g', sharp: 'h' },\n    { natural: 'n', flat: 'h', sharp: 'j' },\n    { natural: 'm', flat: 'j', sharp: 'k' },\n    { natural: ',', flat: 'k', sharp: 'l' },\n    { natural: '.', flat: 'l', sharp: ';' },\n    { natural: '/', flat: ';', sharp: \"'\" },\n  ],\n  HOME_ROW: [\n    { natural: 'a', flat: 'q', sharp: 'w' },\n    { natural: 's', flat: 'w', sharp: 'e' },\n    { natural: 'd', flat: 'e', sharp: 'r' },\n    { natural: 'f', flat: 'r', sharp: 't' },\n    { natural: 'g', flat: 't', sharp: 'y' },\n    { natural: 'h', flat: 'y', sharp: 'u' },\n    { natural: 'j', flat: 'u', sharp: 'i' },\n    { natural: 'k', flat: 'i', sharp: 'o' },\n    { natural: 'l', flat: 'o', sharp: 'p' },\n    { natural: ';', flat: 'p', sharp: '[' },\n    { natural: \"'\", flat: '[', sharp: ']' },\n  ],\n  QWERTY_ROW: [\n    { natural: 'q', flat: '1', sharp: '2' },\n    { natural: 'w', flat: '2', sharp: '3' },\n    { natural: 'e', flat: '3', sharp: '4' },\n    { natural: 'r', flat: '4', sharp: '5' },\n    { natural: 't', flat: '5', sharp: '6' },\n    { natural: 'y', flat: '6', sharp: '7' },\n    { natural: 'u', flat: '7', sharp: '8' },\n    { natural: 'i', flat: '8', sharp: '9' },\n    { natural: 'o', flat: '9', sharp: '0' },\n    { natural: 'p', flat: '0', sharp: '-' },\n    { natural: '[', flat: '-', sharp: '=' },\n  ],\n};\n"],"names":["SORTED_PITCHES","ACCIDENTAL_PITCHES","PITCH_INDEXES","C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B","MIDI_NUMBER_C0","MIN_MIDI_NUMBER","MAX_MIDI_NUMBER","NOTE_REGEX","NOTES_IN_OCTAVE","fromNote","note","Error","match","exec","toLowerCase","letter","accidental","octave","pitchName","toUpperCase","pitchIndex","parseInt","buildMidiNumberAttributes","midiNumber","Math","floor","isAccidental","includes","buildMidiNumberAttributesCache","range","reduce","cache","midiNumberAttributesCache","getAttributes","attrs","NATURAL_MIDI_NUMBERS","filter","Key","props","onPlayNoteInput","console","log","onStopNoteInput","OCTAVE_WIDTH","MidiNumbers","pitchPosition","pitchPositions","octavePosition","getAbsoluteKeyPosition","noteRange","first","naturalKeyWidth","accidentalWidthRatio","gliss","useTouchEvents","active","highlighted","disabled","children","classNames","left","ratioToPercentage","getRelativeKeyPosition","width","React","Component","PropTypes","number","isRequired","bool","func","object","node","ratio","Keyboard","last","getMidiNumbers","length","getNaturalKeyCount","keyWidth","getNaturalKeyWidth","keyWidthToHeight","className","getWidth","height","getHeight","map","isActive","activeNotes","isHighlighted","highlightedNotes","renderNoteLabel","noteRangePropType","arrayOf","string","isNaturalMidiNumber","value","propName","componentName","ControlledPiano","isMouseDown","prevActiveNotes","nextActiveNotes","notesStopped","difference","notesStarted","forEach","playNote","stopNote","key","keyboardShortcuts","shortcut","find","sh","event","ctrlKey","metaKey","shiftKey","getMidiNumberForKey","setState","keyboardShortcut","getKeyForMidiNumber","window","addEventListener","onKeyDown","onKeyUp","removeEventListener","prevProps","prevState","handleNoteChanges","onMouseDown","onMouseUp","onTouchStart","state","shape","Piano","concat","otherProps","handlePlayNoteInput","handleStopNoteInput","createKeyboardShortcuts","firstNote","lastNote","keyboardConfig","currentMidiNumber","naturalKeyIndex","push","flat","natural","create","BOTTOM_ROW","sharp","HOME_ROW","QWERTY_ROW"],"mappings":"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"}